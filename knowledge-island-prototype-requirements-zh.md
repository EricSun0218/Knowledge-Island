# 知识岛前端原型需求文档（基于当前代码）

版本：v0.1  
更新时间：2026-01-06  
范围：仅覆盖当前前端原型所体现的功能与交互

---

## 1. 背景与目标
### 1.1 背景
知识岛面向知识付费场景，核心矛盾是“创作者不希望资料被下载/复制后盗版”与“学习者希望用 AI 辅助学习”的冲突。平台希望在保证内容可用、可学、可增值的同时，尽量降低内容外泄风险。

### 1.2 产品目标
- 为学习者提供沉浸式阅读与 AI 辅助学习能力（文本、图片、视频、音频、PDF）。
- 为创作者提供内容上传、管理、发布与数据分析能力。
- 支撑 B2C2C 商业模式：创作者上传 → 自有渠道售卖 → 学习者消费 → AI 积分分成。

---

## 2. 角色与权限
### 2.1 角色定义
- 学习者/买家（Reader）：阅读已购买知识库，使用 AI 功能消耗积分。
- 创作者/卖家（Creator）：上传与管理内容，设置发布策略，查看数据。

### 2.2 权限与能力（当前原型范围）
- 学习者：阅读文件、AI 聊天、语音对话、TTS 朗读、查看目录、跳转内容。
- 创作者：创建项目、管理文件结构、编辑文本、配置发布策略、查看分析数据。

---

## 3. 信息架构与主流程
### 3.1 入口与主页面
默认进入某一知识库的阅读页（Reader Dashboard）。

### 3.2 页面跳转
- 头像点击 → 用户个人看板（User Profile）。
- 左侧作者信息点击 → 创作者公开主页（Creator Public Profile）。
- 用户看板中点击“创作者工作室” → 创作者工作室（Creator Studio）。

---

## 4. 阅读端（Reader Dashboard）
### 4.1 顶部栏（Header）
- 左侧展示品牌 Logo。
- 右侧展示会员等级与积分余额。
- 头像按钮进入用户个人看板。

### 4.2 左侧文件树
- 展示知识库目录结构（支持多级文件夹）。
- 文件类型：folder、text、image、audio、video、pdf。
- 点击文件夹展开/收起，点击文件切换内容。
- 左侧栏支持收起/展开，收起后在内容区左上显示浮动按钮恢复。

### 4.3 内容区（Content Viewer）
- 内容区显示文件名时会去掉扩展名（例如 `.md`、`.mp4` 等）。
#### 文本（text）
- 采用自定义 Markdown 渲染规则：
  - `#`、`##`、`###` 渲染为一级、二级、三级标题。
  - `![alt](url)` 渲染图片。
  - 支持简单列表与 `**bold**` 粗体。
- 支持正文 TTS 朗读播放器（多语音/语速选择、进度与时长显示）。
- 支持文本选中浮层工具：
  - 复制、解释、总结（当前为原型交互）。

#### 图片（image）
- 居中展示，支持较大尺寸预览。

#### 视频（video）
- 内嵌 HTML5 video 播放器。

#### 音频（audio）
- 专用播放卡片 + HTML5 audio 控件。

#### PDF（pdf）
- 内嵌 iframe 阅读。
- 提供“新标签页打开”链接。

### 4.4 目录/大纲（TOC）
当文本文件存在标题时：
- 解析生成大纲。
- 侧边浮层可快速跳转指定标题位置。
- 仅在左侧文件树收起时显示。

### 4.5 右侧工具条（Right Toolbar）
固定悬浮按钮组：
- 打开/关闭 AI 聊天面板。
- 生成摘要（原型占位）。
- 生成思维导图（原型占位）。
- 生成播客（原型占位）。
- 回到顶部。
- 仅在桌面大屏（`xl` 断点）显示，AI 聊天打开时隐藏。

### 4.6 右侧 AI 聊天面板（AI Chat）
- 默认关闭，通过右侧工具条打开。
- 聊天消息：
  - 用户消息右对齐气泡。
  - AI 消息左对齐，并支持引用文件链接。
- 输入框：
  - 支持回车发送。
  - 空输入时点击按钮进入语音模式。
- 语音模式：
  - 申请麦克风权限，开启实时语音对话。
  - 提示连接/播放状态。
  - 可一键退出回文本模式。
- 引用系统：
  - AI 回复中以 `[[文件名]]` 格式生成引用。
  - 引用显示为可点击编号，点击跳转对应文件。
  - 引用 tooltip 展示的文件名会去掉扩展名。
- 上下文拼接：
  - 系统指令包含当前文件内容 + 文件树结构，用于 AI 回答。

---

## 5. 用户个人看板（User Profile）
### 5.1 个人信息
- 展示头像、昵称、用户名、加入时间。

### 5.2 会员与积分（钱包）
- 显示会员等级、到期时间、积分余额。
- 提供“账户管理”入口（原型占位）。

### 5.3 创作者工作室入口
- 入口卡片展示创作者状态与快捷入口。
- 点击在新页面打开 Creator Studio。

### 5.4 已购知识库列表
- 卡片形式展示封面、名称、作者、学习进度。
- 支持进度条与进入按钮。
- 追加“探索更多”入口卡片。

---

## 6. 创作者公开主页（Creator Public Profile）
- 展示创作者头像、简介、社交链接。
- 关注按钮（原型交互）。
- 统计数据：订阅人数、知识库数量、评分、个人网站。
- 列表展示创作者知识库项目，含状态与浏览/销售数据。

---

## 7. 创作者工作室（Creator Studio）
### 7.1 左侧主导航
- 项目（Projects）
- 数据（Analytics）
- 退出工作室

### 7.2 项目列表（Projects View）
- 展示项目卡片：标题、简介、状态、浏览量、销售量。
- “创建新项目”入口卡片。
- 选择项目进入编辑器。

### 7.3 数据仪表盘（Analytics View）
- 核心指标卡片：
  - 总收入、总读者、活跃订阅、平均阅读时长。
- 读者常见问题列表：
  - 显示提问次数、时间、关联文件。
  - 支持“全局回答”“固定为 FAQ”按钮（原型占位）。

### 7.4 内容编辑器（Editor View）
- 左侧文件树：
  - 创建文件夹、创建文本、上传文件（原型占位）。
- 顶部工具条：
  - 保存、发布入口。
- 文本编辑：
  - 左侧 Markdown 编辑区。
  - 右侧实时预览区（文本直出）。
- 非文本文件：
  - 提示暂不支持编辑/预览。

### 7.5 发布设置弹窗
- 价格设置（积分）
  - 文本阅读单价
  - AI 语音单价
- 权限设置
  - 允许复制
  - 允许下载
  - 水印（配置存在，UI 未呈现）
- 提交发布 / 取消。

---

## 8. 数据模型（基于 types.ts）
- FileNode
  - id, name, type, content, children, isOpen
  - publishConfig, lastModified
- PublishConfig
  - isPublished, textCost, audioCost
  - permissions: allowCopy, allowDownload, watermark
- Project
  - title, description, status, stats, lastModified
- CreatorAnalytics
  - totalRevenue, totalReaders, activeSubscribers, avgTimeSpent, recentQuestions
- User / PurchasedKnowledge
  - 会员等级、积分、购买进度等

---

## 9. 非功能与技术约束（原型可见）
- 前端为 Vite + React 原型，数据来自 Mock。
- AI 能力依赖 `@google/genai`：
  - 文本对话（gemini-3-flash-preview）
  - 实时语音（gemini-2.5-flash-native-audio-preview-09-2025）
  - TTS（gemini-2.5-flash-preview-tts）
- 语音与 TTS 依赖浏览器 Web Audio 与 MediaDevices。
- 动效与交互以 Tailwind 类实现，整体偏高动效与强视觉表现。

---

## 10. 未覆盖/待补充范围（建议后续补齐）
- 实际上传/存储/鉴权流程。
- 支付与积分充值体系。
- 内容保护策略的前端与服务端联动（禁止下载/复制、动态水印）。
- 搜索、筛选、排序、推荐等内容分发能力。
- 创作者收益结算与对账系统。
